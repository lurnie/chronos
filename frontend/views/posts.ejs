<!DOCTYPE html>
<html>
<%- include('./partials/head.ejs') %>

<body>
    <%- include('./partials/nav.ejs') %>
    <%- include('./functions/getDateString.ejs') %>

    <h1>Posts</h1>
    <% if (user.userId) { %>
        <div class="post send-box">
            <div class="post-user-input" contenteditable="true"></div>
            <button class="post-button">Send</button>
        </div>
    <% } %>
    <% posts.forEach(post => { %>
        <div class="post">
            <a class="username-link" href="/users/<%=post.username%>"><div class="post-username"><%=post.username%></div></a>
            <a class="post-link" href="/posts/<%=post.post_id%>">
                <div>
                    <span class="post-content"><%=post.contents%></span>
                    <span class="post-date"><%=getDateString(post.date_created)%></span>
                </div>
            </a>
            <div id="dropdown-<%=post.post_id%>" class="dropdown">
                <button class="dropdown-button">...</button>
                <div class="content">
                    <% if (user.username === post.username || user.admin) { %>
                        <button class="dropdown-element delete-post">Delete</button>
                    <% } %>
                    <button class="dropdown-element"><a href="/users/<%=post.username%>">Go To Profile</a></button>
                </div>
            </div>
        </div>

    <% }) %>
    <script src='/scripts/posts.js' type="module"></script>
</body>
</html>